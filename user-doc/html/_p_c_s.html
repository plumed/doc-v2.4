<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: PCS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_c_s.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PCS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the isdb <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculates the Pseudocontact shift of a nucleus determined by the presence of a metal ion susceptible to anisotropic magnetization.</p>
<p>The PCS of an atomic nucleus depends on the \(\theta\) angle between the vector from the spin-label to the nucleus and the external magnetic field and the module of the vector itself <a class="el" href="citelist.html#CITEREF_Camilloni:2015jf">[27]</a> . While in principle the averaging resulting from the tumbling should remove the pseudocontact shift, in presence of the NMR magnetic field the magnatically anisotropic molecule bound to system will break the rotational symmetry does resulting in measurable PCSs and RDCs.</p>
<p>PCSs can also be calculated using a Single Value Decomposition approach, in this case the code rely on the a set of function from the GNU Scientific Library (GSL). (With SVD forces are not currently implemented).</p>
<p>Replica-Averaged simulations can be perfomed using PCSs, <a class="el" href="_e_n_s_e_m_b_l_e.html">ENSEMBLE</a>, <a class="el" href="_s_t_a_t_s.html">STATS</a> and <a class="el" href="_r_e_s_t_r_a_i_n_t.html">RESTRAINT</a> . Metainference simulations can be performed with this CV and <a class="el" href="_m_e_t_a_i_n_f_e_r_e_n_c_e.html">METAINFERENCE</a> .</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>The names of the components in this action can be customized by the user in the actions input file. However, in addition to these customizable components the following quantities will always be output</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> sigma </b> </td><td>uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> sigmaMean </b> </td><td>uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> acceptSigma </b> </td><td>MC acceptance   </td></tr>
<tr>
<td width="15%"><b> rdc </b> </td><td>the calculated # RDC   </td></tr>
</table>
<p>In addition the following quantities can be calculated by employing the keywords listed below</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> acceptScale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>MC acceptance   </td></tr>
<tr>
<td width="5%"><b> weight </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>weights of the weighted average   </td></tr>
<tr>
<td width="5%"><b> biasDer </b> </td><td width="10%"><b> REWEIGHT </b>  </td><td>derivatives wrt the bias   </td></tr>
<tr>
<td width="5%"><b> scale </b> </td><td width="10%"><b> SCALEDATA </b>  </td><td>scale parameter   </td></tr>
<tr>
<td width="5%"><b> offset </b> </td><td width="10%"><b> ADDOFFSET </b>  </td><td>offset parameter   </td></tr>
<tr>
<td width="5%"><b> ftilde </b> </td><td width="10%"><b> GENERIC </b>  </td><td>ensemble average estimator   </td></tr>
<tr>
<td width="5%"><b> exp </b> </td><td width="10%"><b> SVD/ADDCOUPLINGS </b>  </td><td>the experimental # RDC   </td></tr>
</table>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>the couple of atoms involved in each of the bonds for which you wish to calculate the RDC. Keywords like ATOMS1, ATOMS2, ATOMS3,... should be listed and one dipolar coupling will be calculated for each ATOMS keyword you specify. You can use multiple instances of this keyword i.e. ATOMS1, ATOMS2, ATOMS3...   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NOISETYPE </b> </td><td>( default=MGAUSS ) functional form of the noise (GAUSS,MGAUSS,OUTLIERS,MOUTLIERS,GENERIC)   </td></tr>
<tr>
<td width="15%"><b> LIKELIHOOD </b> </td><td>( default=GAUSS ) the likelihood for the GENERIC metainference model, GAUSS or LOGN   </td></tr>
<tr>
<td width="15%"><b> DFTILDE </b> </td><td>( default=0.1 ) fraction of sigma_mean used to evolve ftilde   </td></tr>
<tr>
<td width="15%"><b> SCALE0 </b> </td><td>( default=1.0 ) initial value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> OFFSET0 </b> </td><td>( default=0.0 ) initial value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_PRIOR </b> </td><td>( default=FLAT ) either FLAT or GAUSSIAN   </td></tr>
<tr>
<td width="15%"><b> SIGMA0 </b> </td><td>( default=1.0 ) initial value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MIN </b> </td><td>( default=0.0 ) minimum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MAX </b> </td><td>( default=10. ) maximum value of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> OPTSIGMAMEAN </b> </td><td>( default=NONE ) Set to NONE/SEM to manually set sigma mean, or to estimate it on the fly   </td></tr>
<tr>
<td width="15%"><b> WRITE_STRIDE </b> </td><td>( default=1000 ) write the status to a file every N steps, this can be used for restart/continuation   </td></tr>
<tr>
<td width="15%"><b> GYROM </b> </td><td>( default=1. ) Add the product of the gyromagnetic constants for the bond.   </td></tr>
<tr>
<td width="15%"><b> SCALE </b> </td><td>( default=1. ) Add the scaling factor to take into account concentration and other effects.   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> DOSCORE </b> </td><td>( default=off ) activate metainference   </td></tr>
<tr>
<td width="15%"><b> NOENSEMBLE </b> </td><td>( default=off ) don't perform any replica-averaging   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT </b> </td><td>( default=off ) simple REWEIGHT using the ARG as energy   </td></tr>
<tr>
<td width="15%"><b> SCALEDATA </b> </td><td>( default=off ) Set to TRUE if you want to sample a scaling factor common to all values and replicas   </td></tr>
<tr>
<td width="15%"><b> ADDOFFSET </b> </td><td>( default=off ) Set to TRUE if you want to sample an offset common to all values and replicas   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> SVD </b> </td><td>( default=off ) Set to TRUE if you want to backcalculate using Single Value Decomposition (need GSL at compilation time).   </td></tr>
<tr>
<td width="15%"><b> ADDCOUPLINGS </b> </td><td><p class="starttd">( default=off ) Set to TRUE if you want to have fixed components with the experimetnal values.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td>the input for this action is the scalar output from one or more other actions. The particular scalars that you will use are referenced using the label of the action. If the label appears on its own then it is assumed that the Action calculates a single scalar value. The value of this scalar is thus used as the input to this new action. If * or *.* appears the scalars calculated by all the proceding actions in the input file are taken. Some actions have multi-component outputs and each component of the output has a specific label. For example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> action labelled dist may have three componets x, y and z. To take just the x component you should use dist.x, if you wish to take all three components then use dist.*.More information on the referencing of Actions can be found in the section of the manual on the PLUMED <a class="el" href="_syntax.html">Getting Started</a>. Scalar values can also be referenced using POSIX regular expressions as detailed in the section on <a class="el" href="_regex.html">Regular Expressions</a>. To use this feature you you must compile PLUMED with the appropriate flag. You can use multiple instances of this keyword i.e. ARG1, ARG2, ARG3...   </td></tr>
<tr>
<td width="15%"><b> AVERAGING </b> </td><td>Stride for calculation of averaged weights and sigma_mean   </td></tr>
<tr>
<td width="15%"><b> SCALE_MIN </b> </td><td>minimum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> SCALE_MAX </b> </td><td>maximum value of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> DSCALE </b> </td><td>maximum MC move of the scaling factor   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MIN </b> </td><td>minimum value of the offset   </td></tr>
<tr>
<td width="15%"><b> OFFSET_MAX </b> </td><td>maximum value of the offset   </td></tr>
<tr>
<td width="15%"><b> DOFFSET </b> </td><td>maximum MC move of the offset   </td></tr>
<tr>
<td width="15%"><b> DSIGMA </b> </td><td>maximum MC move of the uncertainty parameter   </td></tr>
<tr>
<td width="15%"><b> SIGMA_MEAN0 </b> </td><td>starting value for the uncertainty in the mean estimate   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature - this is only needed if code doesnt' pass the temperature to plumed   </td></tr>
<tr>
<td width="15%"><b> MC_STEPS </b> </td><td>number of MC steps   </td></tr>
<tr>
<td width="15%"><b> MC_STRIDE </b> </td><td>MC stride   </td></tr>
<tr>
<td width="15%"><b> MC_CHUNKSIZE </b> </td><td>MC chunksize   </td></tr>
<tr>
<td width="15%"><b> STATUS_FILE </b> </td><td>write a file with all the data usefull for restart/continuation of Metainference   </td></tr>
<tr>
<td width="15%"><b> SELECTOR </b> </td><td>name of selector   </td></tr>
<tr>
<td width="15%"><b> NSELECT </b> </td><td>range of values for selector [0, N-1]   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td>allows per-action setting of restart (YES/NO/AUTO)   </td></tr>
<tr>
<td width="15%"><b> COUPLING </b> </td><td><p class="starttd">Add an experimental value for each coupling (needed by SVD and usefull for ef STATS). You can use multiple instances of this keyword i.e. COUPLING1, COUPLING2, COUPLING3...  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the following example five PCSs are defined and their correlation with respect to a set of experimental data is calculated and restrained. In addition, and only for analysis purposes, the same PCSs are calculated using a Single Value Decomposition algorithm.</p>
<pre class="fragment">
<a href="./_p_c_s.html" style="color:green">PCS</a> ...
ATOMS1=20,21
ATOMS2=20,38
ATOMS3=20,57
ATOMS4=20,77
ATOMS5=20,93
LABEL=nh
... PCS

enh: <a href="./_e_n_s_e_m_b_l_e.html" style="color:green">ENSEMBLE</a> ARG=nh.*

st: <a href="./_s_t_a_t_s.html" style="color:green">STATS</a> ARG=enh.* PARAMETERS=8.17,-8.271,-10.489,-9.871,-9.152

pcse: <a href="./_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> ARG=st.corr KAPPA=0. SLOPE=-25000.0 AT=1.

<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=st.corr,pcse.bias FILE=colvar
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_add_mod.html">Additional Modules</a></li><li class="navelem"><a class="el" href="_i_s_d_b.html">PLUMED-ISDB</a></li><li class="navelem"><a class="el" href="_i_s_d_b_colvar.html">CVs Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
