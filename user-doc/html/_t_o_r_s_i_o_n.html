<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: TORSION</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_t_o_r_s_i_o_n.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">TORSION </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the colvar <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Calculate a torsional angle.</p>
<p>This command can be used to compute the torsion between four atoms or alternatively to calculate the angle between two vectors projected on the plane orthogonal to an axis.</p>
<dl class="section user"><dt>The atoms involved can be specified using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> ATOMS </b> </td><td>the four atoms involved in the torsional angle   </td></tr>
</table>
<dl class="section user"><dt>Or alternatively by using</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> AXIS </b> </td><td>two atoms that define an axis. You can use this to find the angle in the plane perpendicular to the axis between the vectors specified using the VECTOR1 and VECTOR2 keywords.   </td></tr>
<tr>
<td width="15%"><b> VECTOR1 </b> </td><td>two atoms that define a vector. You can use this in combination with VECTOR2 and AXIS   </td></tr>
<tr>
<td width="15%"><b> VECTOR2 </b> </td><td>two atoms that define a vector. You can use this in combination with VECTOR1 and AXIS   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> NOPBC </b> </td><td>( default=off ) ignore the periodic boundary conditions when calculating distances   </td></tr>
<tr>
<td width="15%"><b> COSINE </b> </td><td><p class="starttd">( default=off ) calculate cosine instead of dihedral  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>This input tells plumed to print the torsional angle between atoms 1, 2, 3 and 4 on file COLVAR. </p><pre class="fragment">
t: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=1,2,3,4
<span style="color:blue"># this is an alternative, equivalent, definition:</span>
<span style="color:blue"># t: TORSION VECTOR1=2,1 AXIS=2,3 VECTOR2=3,4</span>
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=t FILE=COLVAR
</pre><p>If you are working with a protein you can specify the special named torsion angles \(\phi\), \(\psi\), \(\omega\) and \(\chi_1\) by using TORSION in combination with the <a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a> command. This can be done by using the following syntax.</p>
<pre class="fragment">
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> MOLTYPE=protein STRUCTURE=myprotein.pdb
t1: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=@phi-3
t2: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=@psi-4
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=t1,t2 FILE=colvar STRIDE=10
</pre><p>Here, @phi-3 tells plumed that you would like to calculate the \(\phi\) angle in the third residue of the protein. Similarly @psi-4 tells plumed that you want to calculate the \(\psi\) angle of the 4th residue of the protein.</p>
<p>Both of the previous examples specify that the torsion angle should be calculated based on the position of four atoms. For the first example in particular the assumption when the torsion is specified in this way is that there are chemical bonds between atoms 1 and 2, atoms 2 and 3 and atoms 3 and 4. In general, however, a torsional angle measures the angle between two planes, which have at least one vector in common. As shown below, there is thus an alternate, more general, way through which we can define a torsional angle:</p>
<pre class="fragment">
t1: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> VECTOR1=1,2 AXIS=3,4 VECTOR2=5,6
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=t1 FILE=colvar STRIDE=20
</pre><p>This input instructs PLUMED to calculate the angle between the plane containing the vector connecting atoms 1 and 2 and the vector connecting atoms 3 and 4 and the plane containing this second vector and the vector connecting atoms 5 and 6. We can even use PLUMED to calculate the torsional angle between two bond vectors around the z-axis as shown below:</p>
<pre class="fragment">
a0: <a href="./_f_i_x_e_d_a_t_o_m.html" style="color:green">FIXEDATOM</a> AT=0,0,0
az: <a href="./_f_i_x_e_d_a_t_o_m.html" style="color:green">FIXEDATOM</a> AT=0,0,1
t1: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> VECTOR1=1,2 AXIS=a0,az VECTOR2=5,6
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=t1 FILE=colvar STRIDE=20
</pre> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
