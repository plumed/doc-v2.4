<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: PATH</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_p_a_t_h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PATH </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the mapping <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Path collective variables with a more flexible framework for the distance metric being used.</p>
<p>The Path Collective Variables developed by Branduardi and co-workers <a class="el" href="citelist.html#CITEREF_brand07">[21]</a> allow one to compute the progress along a high-dimensional path and the distance from the high-dimensional path. The progress along the path (s) is computed using:</p>
<p class="formulaDsp">
\[ s = \frac{ \sum_{i=1}^N i \exp( -\lambda R[X - X_i] ) }{ \sum_{i=1}^N \exp( -\lambda R[X - X_i] ) } \]
</p>
<p>while the distance from the path (z) is measured using:</p>
<p class="formulaDsp">
\[ z = -\frac{1}{\lambda} \ln\left[ \sum_{i=1}^N \exp( -\lambda R[X - X_i] ) \right] \]
</p>
<p>In these expressions \(N\) high-dimensional frames ( \(X_i\)) are used to describe the path in the high-dimensional space. The two expressions above are then functions of the distances from each of the high-dimensional frames \(R[X - X_i]\). Within PLUMED there are multiple ways to define the distance from a high-dimensional configuration. You could calculate the RMSD distance or you could calculate the ammount by which a set of collective variables change. As such this implementation of the path cv allows one to use all the difference distance metrics that are discussed in <a class="el" href="dists.html">Distances from reference configurations</a>. This is as opposed to the alternative implementation of path (<a class="el" href="_p_a_t_h_m_s_d.html">PATHMSD</a>) which is a bit faster but which only allows one to use the RMSD distance.</p>
<p>The \(s\) and \(z\) variables are calculated using the above formulas by default. However, there is an alternative method of calculating these collective variables, which is detailed in <a class="el" href="citelist.html#CITEREF_bernd-path">[39]</a>. This alternative method uses the tools of geometry (as opposed to algebra, which is used in the equations above). In this alternative formula the progress along the path \(s\) is calculated using:</p>
<p class="formulaDsp">
\[ s = i_2 + \textrm{sign}(i_2-i_1) \frac{ \sqrt{( \mathbf{v}_1\cdot\mathbf{v}_2 )^2 - |\mathbf{v}_3|^2(|\mathbf{v}_1|^2 - |\mathbf{v}_2|^2) } }{2|\mathbf{v}_3|^2} - \frac{\mathbf{v}_1\cdot\mathbf{v}_3 - |\mathbf{v}_3|^2}{2|\mathbf{v}_3|^2} \]
</p>
<p>where \(\mathbf{v}_1\) and \(\mathbf{v}_3\) are the vectors connecting the current position to the closest and second closest node of the path, respectfully and \(i_1\) and \(i_2\) are the projections of the closest and second closest frames of the path. \(\mathbf{v}_2\), meanwhile, is the vector connecting the closest frame to the second closest frame. The distance from the path, \(z\) is calculated using:</p>
<p class="formulaDsp">
\[ z = \sqrt{ \left[ |\mathbf{v}_1|^2 - |\mathbf{v}_2| \left( \frac{ \sqrt{( \mathbf{v}_1\cdot\mathbf{v}_2 )^2 - |\mathbf{v}_3|^2(|\mathbf{v}_1|^2 - |\mathbf{v}_2|^2) } }{2|\mathbf{v}_3|^2} - \frac{\mathbf{v}_1\cdot\mathbf{v}_3 - |\mathbf{v}_3|^2}{2|\mathbf{v}_3|^2} \right) \right]^2 } \]
</p>
<p>The symbols here are as they were for \(s\). If you would like to use these equations to calculate \(s\) and \(z\) then you should use the GPATH flag. The values of \(s\) and \(z\) can then be referenced using the gspath and gzpath labels.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default the value of the calculated quantity can be referenced elsewhere in the input file by using the label of the action. Alternatively this Action can be used to calculate the following quantities by employing the keywords listed below. These quanties can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Keyword </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="5%"><b> gspath </b> </td><td width="10%"><b> GPATH </b>  </td><td>the position on the path calculated using trigonometry   </td></tr>
<tr>
<td width="5%"><b> gzpath </b> </td><td width="10%"><b> GPATH </b>  </td><td>the distance from the path calculated using trigonometry   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> REFERENCE </b> </td><td>a pdb file containing the set of reference configurations   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>( default=OPTIMAL-FAST ) the manner in which distances are calculated. More information on the different metrics that are available in PLUMED can be found in the section of the manual on <a class="el" href="dists.html">Distances from reference configurations</a>   </td></tr>
<tr>
<td width="15%"><b> LAMBDA </b> </td><td>( default=0 ) the value of the lambda parameter for paths   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> SERIAL </b> </td><td>( default=off ) do the calculation in serial. Do not parallelize   </td></tr>
<tr>
<td width="15%"><b> TIMINGS </b> </td><td>( default=off ) output information on the timings of the various parts of the calculation   </td></tr>
<tr>
<td width="15%"><b> DISABLE_CHECKS </b> </td><td>( default=off ) disable checks on reference input structures.   </td></tr>
<tr>
<td width="15%"><b> NOZPATH </b> </td><td>( default=off ) do not calculate the zpath position   </td></tr>
<tr>
<td width="15%"><b> NOSPATH </b> </td><td><p class="starttd">( default=off ) do not calculate the spath position  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> GPATH </b> </td><td><p class="starttd">calculate the position on the path using trigonometry The final value can be referenced using <em>label</em>.gpath. You can use multiple instances of this keyword i.e. GPATH1, GPATH2, GPATH3... The corresponding values are then referenced using <em>label</em>.gpath-1, <em>label</em>.gpath-2, <em>label</em>.gpath-3...  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>In the example below the path is defined using RMSD distance from frames. The reference frames in the path are defined in the pdb file. In this frame each configuration in the path is separated by a line containing just the word END.</p>
<pre class="fragment">
p1: <a href="./_p_a_t_h.html" style="color:green">PATH</a> REFERENCE=file.pdb TYPE=OPTIMAL LAMBDA=500.0
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=p1.sss,p1.zzz STRIDE=1 FILE=colvar FMT=%8.4f
</pre><p>In the example below the path is defined using the values of two torsional angles (t1 and t2). In addition, the \(s\) and \(z\) are calculated using the geometric expressions described above rather than the alegebraic expressions that are used by default.</p>
<pre class="fragment">
t1: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=5,7,9,15
t2: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=7,9,15,17
pp: <a href="./_p_a_t_h.html" style="color:green">PATH</a> TYPE=EUCLIDEAN REFERENCE=epath.pdb GPATH NOSPATH NOZPATH
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=pp.* FILE=colvar
</pre><p>Notice that the LAMBDA parameter is not required here as we are not calculating \(s\) and \(s\) using the algebraic formulae defined earlier. The positions of the frames in the path are defined in the file epath.pdb. An extract from this file looks as shown below.</p>
<pre class="fragment">REMARK ARG=t1,t2 t1=-4.25053  t2=3.88053
END
REMARK ARG=t1,t2 t1=-4.11     t2=3.75
END
REMARK ARG=t1,t2 t1=-3.96947  t2=3.61947
END
</pre><p>The remarks in this pdb file tell PLUMED the labels that are being used to define the position in the high dimensional space and the values that these arguments have at each point on the path.</p>
<p>The following input instructs PLUMED to calculate the values of the path collective variables. The frames that make up this path are defined in the file all.pdb and all distances are measured using the OPTIMAL metric that is discussed in the manual page on <a class="el" href="_r_m_s_d.html">RMSD</a>.</p>
<pre class="fragment">
p2: <a href="./_p_a_t_h.html" style="color:green">PATH</a> REFERENCE=all.pdb LAMBDA=69087
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=p2.spath,p2.zpath STRIDE=1 FILE=colvar
</pre><p>If you wish to use collective variable values in the definition of your path you would use an input file with something like this:</p>
<pre class="fragment">
d1: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=1,2
d2: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=3,4a
p2: <a href="./_p_a_t_h.html" style="color:green">PATH</a> REFERENCE=mypath.pdb LAMBDA=2 TYPE=EUCLIDEAN
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=p2.spath,p2.zpath STRIDE=1 FILE=colvar
</pre><p>The corresponding pdb file containing the definitions of the frames in the path would then look like this:</p>
<pre class="fragment">DESCRIPTION: a defintiion of a PATH
REMARK TYPE=EUCLIDEAN
REMARK ARG=d1,d2
REMARK d1=1.0 d2=1.0
END
REMARK TYPE=EUCLIDEAN
REMARK ARG=d1,d2
REMARK d1=2.0 d2=2.0
END
</pre><p>For each frame in the path you must specify the arguments that should be used to calculate the distance between the instantaneous configuration of the system and the reference configurations together with the values that these arguments take in each of the reference configurations. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li><li class="navelem"><a class="el" href="_colvar.html">CV Documentation</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
