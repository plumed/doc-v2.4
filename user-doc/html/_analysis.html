<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: Analysis</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_analysis.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Analysis </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>PLUMED can be used to analyse trajectories either on the fly during an MD run or via postprocessing a trajectory using <a class="el" href="driver.html">driver</a>. About the simplest form of analysis that PLUMED can perform involves printing information to a file. PLUMED can output various different kinds of information to files as described below:</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_c_o_m_m_i_t_t_o_r.html">COMMITTOR</a>  </td><td>Does a committor analysis.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>  </td><td>Dump selected atoms on a file.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_d_e_r_i_v_a_t_i_v_e_s.html">DUMPDERIVATIVES</a>  </td><td>Dump the derivatives with respect to the input parameters for one or more objects (generally CVs, functions or biases).  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_f_o_r_c_e_s.html">DUMPFORCES</a>  </td><td>Dump the force acting on one of a values in a file.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_m_a_s_s_c_h_a_r_g_e.html">DUMPMASSCHARGE</a>  </td><td>Dump masses and charges on a selected file.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_m_u_l_t_i_c_o_l_v_a_r.html">DUMPMULTICOLVAR</a>  </td><td>Dump atom positions and multicolvar on a file.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_p_r_o_j_e_c_t_i_o_n_s.html">DUMPPROJECTIONS</a>  </td><td>Dump the derivatives with respect to the input parameters for one or more objects (generally CVs, functions or biases).  </td></tr>
<tr>
<td width="5%"><a class="el" href="_p_r_i_n_t.html">PRINT</a>  </td><td>Print quantities to a file.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_u_p_d_a_t_e__i_f.html">UPDATE_IF</a>  </td><td>Conditional update of other actions.  </td></tr>
</table>
<p>The <a class="el" href="_u_p_d_a_t_e__i_f.html">UPDATE_IF</a> action allows you to do more complex things using the above print commands. As detailed in the documentation for <a class="el" href="_u_p_d_a_t_e__i_f.html">UPDATE_IF</a> when you put any of the above actions within an UPDATE_IF block then data will only be output to the file if colvars are within particular ranges. In other words, the above printing commands, in tandem with <a class="el" href="_u_p_d_a_t_e__i_f.html">UPDATE_IF</a>, allow you to identify the frames in your trajectory that satisfy some particular criteria and output information on those frames only.</p>
<p>Another useful command is the <a class="el" href="_c_o_m_m_i_t_t_o_r.html">COMMITTOR</a> command. This command can only be used when running an molecular dynamics trajectory - it cannot be used when analysing a trajectory using <a class="el" href="driver.html">driver</a>. As detailed in the documentation for <a class="el" href="_c_o_m_m_i_t_t_o_r.html">COMMITTOR</a> this command tells PLUMED (and the underlying MD code) to stop the calculation one some criteria is satisified.</p>
<p>A number of more complicated forms of analysis can be performed that take a number of frames from the trajectory as input. In all these commands the STRIDE keyword is used to tell PLUMED how frequently to collect data from the trajectory. In all these methods the output from the analysis is a form of enseble average. If you are running with a bias it is thus likely that you may want to reweight the trajectory frames in order to remove the effect the bias has on the static behavoir of the system. The following methods can thus be used to calculate weights for the various trajectory frames so that the final ensemble average is an average for the cannonical ensemble at the appropriate temperature.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_r_e_w_e_i_g_h_t__b_i_a_s.html">REWEIGHT_BIAS</a>  </td><td>Calculate weights for ensemble averages that negate the effect the bias has on the region of phase space explored  </td></tr>
<tr>
<td width="5%"><a class="el" href="_r_e_w_e_i_g_h_t__m_e_t_a_d.html">REWEIGHT_METAD</a>  </td><td>Calculate the weights configurations should contribute to the histogram in a simulation in which a metadynamics bias acts upon the system.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_r_e_w_e_i_g_h_t__t_e_m_p.html">REWEIGHT_TEMP</a>  </td><td>Calculate weights for ensemble averages allow for the computing of ensemble averages at temperatures lower/higher than that used in your original simulation.  </td></tr>
</table>
<p>You can then calculate ensemble averages using the following actions.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_a_v_e_r_a_g_e.html">AVERAGE</a>  </td><td>Calculate the ensemble average of a collective variable  </td></tr>
<tr>
<td width="5%"><a class="el" href="_h_i_s_t_o_g_r_a_m.html">HISTOGRAM</a>  </td><td>Accumulate the average probability density along a few CVs from a trajectory.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_m_u_l_t_i_c_o_l_v_a_r_d_e_n_s.html">MULTICOLVARDENS</a>  </td><td>Evaluate the average value of a multicolvar on a grid.  </td></tr>
</table>
<p>For many of the above commands data is accumulated on the grids. These grids can be further analysed using one of the actions detailed below at some time. <br />
 </p><table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_c_o_n_v_e_r_t__t_o__f_e_s.html">CONVERT_TO_FES</a>  </td><td>Convert a histogram, \(H(x)\), to a free energy surface using \(F(x) = -k_B T \ln H(x)\).  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_c_u_b_e.html">DUMPCUBE</a>  </td><td>Output a three dimensional grid using the Gaussian cube file format.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_d_u_m_p_g_r_i_d.html">DUMPGRID</a>  </td><td>Output the function on the grid to a file with the PLUMED grid format.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_i_n_d__c_o_n_t_o_u_r.html">FIND_CONTOUR</a>  </td><td>Find an isocontour in a smooth function.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_i_n_d__c_o_n_t_o_u_r__s_u_r_f_a_c_e.html">FIND_CONTOUR_SURFACE</a>  </td><td>Find an isocontour by searching along either the x, y or z direction.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_i_n_d__s_p_h_e_r_i_c_a_l__c_o_n_t_o_u_r.html">FIND_SPHERICAL_CONTOUR</a>  </td><td>Find an isocontour in a three dimensional grid by searching over a Fibonacci sphere.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_o_u_r_i_e_r__t_r_a_n_s_f_o_r_m.html">FOURIER_TRANSFORM</a>  </td><td>Compute the Discrete Fourier Transform (DFT) by means of FFTW of data stored on a 2D grid.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_g_r_i_d__t_o__x_y_z.html">GRID_TO_XYZ</a>  </td><td>Output the function on the grid to an xyz file  </td></tr>
<tr>
<td width="5%"><a class="el" href="_i_n_t_e_g_r_a_t_e__g_r_i_d.html">INTEGRATE_GRID</a>  </td><td>Calculate the total integral of the function on the input grid  </td></tr>
<tr>
<td width="5%"><a class="el" href="_i_n_t_e_r_p_o_l_a_t_e__g_r_i_d.html">INTERPOLATE_GRID</a>  </td><td>Interpolate a smooth function stored on a grid onto a grid with a smaller grid spacing.  </td></tr>
</table>
<p>As an example the following set of commands instructs PLUMED to calculate the distance between atoms 1 and 2 for every 5th frame in the trajectory and to accumulate a histogram from this data which will be output every 100 steps (i.e. when 20 distances have been added to the histogram).</p>
<pre class="fragment">
x: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=1,2
h: <a href="./_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> ARG=x GRID_MIN=0.0 GRID_MAX=3.0 GRID_BIN=100 BANDWIDTH=0.1 STRIDE=5
<a href="./_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> GRID=h FILE=histo STRIDE=100 
</pre><p>It is important to note when using commands such as the above the first frame in the trajectory is assumed to be the initial configuration that was input to the MD code. It is thus ignored. Furthermore, if you are running with driver and you would like to analyse the whole trajectory (without specifying its length) and then print the result you simply call <a class="el" href="_d_u_m_p_g_r_i_d.html">DUMPGRID</a> (or any of the commands above) without a STRIDE keyword as shown in the example below.</p>
<pre class="fragment">
x: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=1,2
h: <a href="./_h_i_s_t_o_g_r_a_m.html" style="color:green">HISTOGRAM</a> ARG=x GRID_MIN=0.0 GRID_MAX=3.0 GRID_BIN=100 BANDWIDTH=0.1 STRIDE=5
<a href="./_d_u_m_p_g_r_i_d.html" style="color:green">DUMPGRID</a> GRID=h FILE=histo 
</pre><p>Please note that even with this calculation the first frame in the trajectory is ignored when computing the histogram.</p>
<p>Notice that all the commands for calculating smooth functions described above calculate some sort of average. There are two ways that you may wish to average the data in your trajectory:</p>
<ul>
<li>You might want to calculate block averages in which the first \(N\)N frames in your trajectory are averaged separately to the second block of \(N\) frames. If this is the case you should use the keyword CLEAR in the input to the action that calculates the smooth function. This keyword is used to specify how frequently you are clearing the stored data.</li>
<li>You might want to calculate an accumulate an average over the whole trajectory and output the average accumulated at step \(N\), step \(2N\)... This is what PLUMED does by default so you do not need to use CLEAR in this case.</li>
</ul>
<h1><a class="anchor" id="dimred"></a>
Dimensionality Reduction</h1>
<p>The remainder of the analysis tools within PLUMED allow one to do some form of dimensionality reduction as detailed below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_c_l_a_s_s_i_c_a_l__m_d_s.html">CLASSICAL_MDS</a>  </td><td>Create a low-dimensional projection of a trajectory using the classical multidimensionalscaling algorithm.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_p_c_a.html">PCA</a>  </td><td>Perform principal component analysis (PCA) using either the positions of the atoms a large number of collective variables as input.  </td></tr>
</table>
<p>As with the grids described previously the STRIDE keyword tells PLUMED how frequently to collect data from the trajectory. The RUN keyword then tells PLUMED how frequently to do the dimensionality reduction. As described above if RUN is not present and you are analysing trajectories using <a class="el" href="driver.html">driver</a> all the data in the traejctory (with the expection of the first frame) will be analysed. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--      -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
