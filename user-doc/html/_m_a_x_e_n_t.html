<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: MAXENT</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_m_a_x_e_n_t.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MAXENT </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><table align="center" frame="void" width="95%%" celpadding="5%%">
<tr>
<td width="70%%"></td><td><b> This is part of the bias <a class="el" href="mymodules.html">module </a></b>   </td></tr>
</table>
<p>Add a linear biasing potential on one or more variables \(f_{i}\left(\boldsymbol{x}\right)\) satisfying the maximum entropy principle as proposed in Ref. <a class="el" href="citelist.html#CITEREF_cesari2016maxent">[2]</a> .</p>
<dl class="section warning"><dt>Warning</dt><dd>Notice that syntax is still under revision and might change</dd></dl>
<p>The resulting biasing potential is given by: </p><p class="formulaDsp">
\[ V_{BIAS}(\boldsymbol{x},t)=K_{B}T\sum_{i=1}^{\#arguments}f_{i}(\boldsymbol{x},t)\lambda_{i}(t) \]
</p>
<p> Lagrangian multipliers \( \lambda_{i}\) are updated, every PACE steps, according to the following update rule: </p><p class="formulaDsp">
\[ \lambda_{i}=\lambda_{i}+\frac{k_{i}}{1+\frac{t}{\tau_{i}}}\left(f_{exp,i}+\xi_{i}\lambda_{i}-f_{i}(\boldsymbol{x})\right) \]
</p>
<p> \(k\) set the initial value of the learning rate and its units are \([observable]^{-2}ps^{-1}\). This can be set with the keyword KAPPA. The number of components for any KAPPA vector must be equal to the number of arguments of the action.</p>
<p>Variable \( \xi_{i}(\lambda) \) is related to the choosen prior to model experimental errors. If a GAUSSIAN prior is used then: </p><p class="formulaDsp">
\[ \xi_{i}(\lambda)=-\lambda_{i}\sigma^{2} \]
</p>
<p> where \( \sigma \) is the typical expected error on the observable \( f_i\). For a LAPLACE prior: </p><p class="formulaDsp">
\[ \xi_{i}(\lambda)=-\frac{\lambda_{i}\sigma^{2}}{1-\frac{\lambda^{2}\sigma^{2}}{2}} \]
</p>
<p> The value of \( \xi(\lambda,t)\) is written in output as a component named: argument name followed by the string _error. Setting \( \sigma =0\) is equivalent to enforce a pure Maximum Entropy restraint without any noise modelling. This method can be also used to enforce inequality restraint as shown in following examples.</p>
<p>Notice that a similar method is available as <a class="el" href="_e_d_s.html">EDS</a>, although with different features and using a different optimization algorithm.</p>
<dl class="section user"><dt>Description of components</dt><dd></dd></dl>
<p>By default this Action calculates the following quantities. These quanties can be referenced elsewhere in the input by using this Action's label followed by a dot and the name of the quantity required from the list below.</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><b> Quantity </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td width="15%"><b> bias </b> </td><td>the instantaneous value of the bias potential   </td></tr>
<tr>
<td width="15%"><b> force2 </b> </td><td>the instantaneous value of the squared force due to this bias potential   </td></tr>
<tr>
<td width="15%"><b> work </b> </td><td>the instantaneous value of the work done by the biasing force   </td></tr>
<tr>
<td width="15%"><b> _work </b> </td><td>the instantaneous value of the work done by the biasing force for each argument. These quantities will named with the arguments of the bias followed by the character string _work.   </td></tr>
<tr>
<td width="15%"><b> _error </b> </td><td>Instantaneous values of the discrepancy between the observable and the restraint center   </td></tr>
<tr>
<td width="15%"><b> _coupling </b> </td><td>Instantaneous values of Lagrangian multipliers. They are also written by default in a separate output file.   </td></tr>
</table>
<dl class="section user"><dt>Compulsory keywords</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> KAPPA </b> </td><td>( default=0.0 ) specifies the initial value for the learning rate   </td></tr>
<tr>
<td width="15%"><b> TAU </b> </td><td>Specify the dumping time for the learning rate.   </td></tr>
<tr>
<td width="15%"><b> TYPE </b> </td><td>specify the restraint type. EQAUL to restrain the variable at a given equilibrium valueINEQUAL&lt; to restrain the variable to be smaller than a given valueINEQUAL&gt; to restrain the variable to be greater than a given value   </td></tr>
<tr>
<td width="15%"><b> AT </b> </td><td>the position of the restraint   </td></tr>
</table>
<dl class="section user"><dt>Options</dt><dd></dd></dl>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="15%"><b> NUMERICAL_DERIVATIVES </b> </td><td>( default=off ) calculate the derivatives for these quantities numerically   </td></tr>
<tr>
<td width="15%"><b> REWEIGHT </b> </td><td>( default=off ) to be used with plumed driver in order to reweight a trajectory a posteriori   </td></tr>
<tr>
<td width="15%"><b> NO_BROADCAST </b> </td><td><p class="starttd">( default=off ) If active will avoid Lagrangian multipliers to be comunicated to other replicas.  </p>
<p class="endtd"></p>
</td></tr>
<tr>
<td width="15%"><b> ARG </b> </td><td>the input for this action is the scalar output from one or more other actions. The particular scalars that you will use are referenced using the label of the action. If the label appears on its own then it is assumed that the Action calculates a single scalar value. The value of this scalar is thus used as the input to this new action. If * or *.* appears the scalars calculated by all the proceding actions in the input file are taken. Some actions have multi-component outputs and each component of the output has a specific label. For example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> action labelled dist may have three componets x, y and z. To take just the x component you should use dist.x, if you wish to take all three components then use dist.*.More information on the referencing of Actions can be found in the section of the manual on the PLUMED <a class="el" href="_syntax.html">Getting Started</a>. Scalar values can also be referenced using POSIX regular expressions as detailed in the section on <a class="el" href="_regex.html">Regular Expressions</a>. To use this feature you you must compile PLUMED with the appropriate flag. You can use multiple instances of this keyword i.e. ARG1, ARG2, ARG3...   </td></tr>
<tr>
<td width="15%"><b> ERROR_TYPE </b> </td><td>specify the prior on the error to use.GAUSSIAN: use a Gaussian priorLAPLACE: use a Laplace prior   </td></tr>
<tr>
<td width="15%"><b> TSTART </b> </td><td>time in ps from where to start averaging the Lagrangian multiplier. By default no average is computed, hence lambda is updated every PACE steps   </td></tr>
<tr>
<td width="15%"><b> TEND </b> </td><td>time in ps where to stop to compute the average of Lagrangian multiplier. From this time until the end of the simulation Lagrangian multipliers are kept fix to the average computed between TSTART and TEND;   </td></tr>
<tr>
<td width="15%"><b> ALPHA </b> </td><td>default=1.0; To be used with LAPLACE KEYWORD, allows to choose a prior function proportional to a Gaussian times an exponential function. ALPHA=1 correspond to the LAPLACE prior.   </td></tr>
<tr>
<td width="15%"><b> SIGMA </b> </td><td>The typical erros expected on observable   </td></tr>
<tr>
<td width="15%"><b> FILE </b> </td><td>Lagrangian multipliers output file. The default name is: label name followed by the string .LAGMULT   </td></tr>
<tr>
<td width="15%"><b> LEARN_REPLICA </b> </td><td>In a multiple replica environment specify which is the reference replica. By default replica 0 will be used.   </td></tr>
<tr>
<td width="15%"><b> APPLY_WEIGHTS </b> </td><td>Vector of weights containing 1 in correspondece of each replica that will receive the lagrangian multiplier from the current one.   </td></tr>
<tr>
<td width="15%"><b> PACE </b> </td><td>the frequency for Lagrangian multipliers update   </td></tr>
<tr>
<td width="15%"><b> PRINT_STRIDE </b> </td><td>stride of Lagrangian multipliers output file. If no STRIDE is passed they are written every time they are updated (PACE).   </td></tr>
<tr>
<td width="15%"><b> FMT </b> </td><td>specify format for Lagrangian multipliers files (usefulf to decrease the number of digits in regtests)   </td></tr>
<tr>
<td width="15%"><b> TEMP </b> </td><td>the system temperature. This is required if you are reweighting.   </td></tr>
<tr>
<td width="15%"><b> RESTART </b> </td><td><p class="starttd">allows per-action setting of restart (YES/NO/AUTO)  </p>
<p class="endtd"></p>
</td></tr>
</table>
<dl class="section user"><dt>Examples</dt><dd></dd></dl>
<p>The following input tells plumed to restrain the distance between atoms 7 and 15 and the distance between atoms 2 and 19, at different equilibrium values, and to print the energy of the restraint. Lagrangian multiplier will be printed on a file called restraint.LAGMULT with a stride set by the variable PACE to 200ps. Moreover plumed will compute the average of each lagrangian multiplier in the window [TSTART,TEND] and use that to continue the simulations with fixed Lagrangian multipliers. </p><pre class="fragment">
<a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=7,15 LABEL=d1
<a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=2,19 LABEL=d2
<a href="./_m_a_x_e_n_t.html" style="color:green">MAXENT</a> ...
ARG=d1,d2
TYPE=EQUAL
AT=0.2,0.5
KAPPA=35000.0,35000.0
TAU=0.02,0.02
PACE=200
TSTART=100
TEND=500
LABEL=restraint
PRINT ARG=restraint.bias
... MAXENT
</pre><p> Lagrangian multipliers will be printed on a file called restraint.bias The following input tells plumed to restrain the distance between atoms 7 and 15 to be greater than 0.2 and to print the energy of the restraint </p><pre class="fragment">
<a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=7,15 LABEL=d
<a href="./_m_a_x_e_n_t.html" style="color:green">MAXENT</a> ARG=d TYPE=INEQUAL&gt; AT=0.02 KAPPA=35000.0 TAU= LABEL=restraint
<a href="./_p_r_i_n_t.html" style="color:green">PRINT</a> ARG=restraint.bias
</pre><p>(See also <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> and <a class="el" href="_p_r_i_n_t.html">PRINT</a>). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="_bias.html">Bias</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
