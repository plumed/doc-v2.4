<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: Trieste tutorial: Real-life applications with complex CVs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('trieste-6.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Trieste tutorial: Real-life applications with complex CVs </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="trieste-6-aims"></a>
Aims</h1>
<p>The aim of this tutorial is to train users to learn the syntax of complex collective variables and use them to analyze MD trajectories of realistic biological systems and bias them with metadynamics.</p>
<h1><a class="anchor" id="trieste-6-objectives"></a>
Objectives</h1>
<p>Once this tutorial is completed students will be able to:</p><ul>
<li>Write the PLUMED input file to use complex CVs for analysis</li>
<li>Analyze trajectories and calculate the free energy of complex biological systems <br />
- Perform error analysis and evaluate convergence in realistic situations</li>
<li>Setup, run, and analyze metadynamics simulations of a complex system</li>
</ul>
<h1><a class="anchor" id="trieste-6-resources"></a>
Resources</h1>
<p>The reference trajectories and input files for the exercises proposed in this tutorial can be downloaded from <code>github</code> using the following command:</p>
<pre class="fragment">wget https://github.com/plumed/trieste2017/raw/master/tutorial/data/tutorial_6.tgz
</pre><p>This tutorial has been tested on a pre-release version of version 2.4. However, it should not take advantage of 2.4-only features, thus should also work with version 2.3.</p>
<h1><a class="anchor" id="trieste-6-intro"></a>
Introduction</h1>
<p>In this tutorial we propose exercises on the following biological systems:</p><ul>
<li>the BRCA1-associated RING domain protein 1 (BARD1 complex)</li>
<li>the cmyc peptide in presence of urea at low concentration (cmyc-urea)</li>
<li>the protein G B1 domain <br />
 The exercise are of increasing difficulties, inputs are partially provided for the first and second cases while for the last one the user is expected to be autonomous.</li>
</ul>
<h1><a class="anchor" id="trieste-6-ex-1"></a>
Exercise 1: analysis of the BARD1 complex simulation</h1>
<p>The BARD1 complex is a heterodimer composed by two domains of 112 and 117 residues each. The system is represented at coarse-grained level using the MARTINI force field.</p>
<p><a class="anchor" id="trieste-6-bard1"></a></p><div class="image">
<img src="trieste-6-bard1.png" alt="trieste-6-bard1.png"/>
<div class="caption">
The BARD1 heterodimer</div></div>
<p> In the TARBALL of this exercise, we provide a long MD simulation of the BARD1 complex in which the two domains explore multiple different conformations.</p>
<dl class="section note"><dt>Note</dt><dd>We encourage the users to get familiar with the system by visualizing the MD trajectory using <code>VMD</code>.</dd></dl>
<p>The users are expected to:</p><ul>
<li>calculate the values of different CVs on the trajectory</li>
<li>estimate the free energies as a function of the CVs tested (mono- and multi-dimensional)</li>
<li>extracting from the trajectories the configurations corresponding to relevant free-energy minima</li>
<li>calculate the error in the associated free energy using the block analysis technique</li>
<li>evaluate the convergence of the original trajectory</li>
</ul>
<p>The users are free to choose his/her favorite CVs and they are encouraged to use the on-line manual to create their own PLUMED input file. However, we encourage all the users to experiment at least with the following CVs:</p>
<p>1) <a class="el" href="_r_m_s_d.html">RMSD</a> and/or <a class="el" href="_d_r_m_s_d.html">DRMSD</a> from the native state</p>
<p>The following line can be added to the <code>plumed.dat</code> file to calculate the <a class="el" href="_r_m_s_d.html">RMSD</a> on the beads representing the backbone aminoacids:</p>
<pre class="fragment">
rmsd: <a href="./_r_m_s_d.html" style="color:green">RMSD</a> REFERENCE=bard1_rmsd.pdb TYPE=OPTIMAL
</pre><p>while this one can be used to calculate the <a class="el" href="_d_r_m_s_d.html">DRMSD</a> between chains:</p>
<pre class="fragment">
drmsd: <a href="./_d_r_m_s_d.html" style="color:green">DRMSD</a> REFERENCE=bard1_drmsd.pdb TYPE=INTER-DRMSD LOWER_CUTOFF=0.1 UPPER_CUTOFF=1.5 
</pre><p>2) Number of inter-chains contacts (specific, i.e. native, or all).</p>
<p>This can be achieved with the <a class="el" href="_c_o_o_r_d_i_n_a_t_i_o_n.html">COORDINATION</a> CVs, as follows:</p>
<pre class="fragment">
<span style="color:blue"># backbone beads index for chain A</span>
chainA: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS=1,3,5,7,9,10,12,15,17,19,21,23,25,27,29,31,33,34,36,38,41,43,45,47,49,51,53,55,57,59,61,63,66,68,70,72,74,76,79,81,83,87,89,93,95,98,102,104,106,108,111,113,115,117,119,122,125,126,128,130,132,134,136,138,140,143,145,147,149,151,154,157,159,161,163,165,167,169,172,176,178,180,182,184,186,188,190,192,195,197,199,201,202,206,208,210,212,214,215,217,219,223,224

<span style="color:blue"># backbone beads index for chain B</span>
chainB: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS=226,228,230,232,234,235,238,239,240,245,246,250,252,255,256,257,259,261,264,266,268,271,273,275,278,280,282,285,287,289,291,293,295,298,300,302,304,306,308,309,310,312,314,318,320,324,326,328,330,332,334,336,338,340,342,343,345,346,348,350,352,354,358,360,362,363,368,370,372,374,376,379,381,383,386,388,390,392,394,396,398,400,402,404,406,409,411,414,416,418,420,424,426,428,430,432,434

coord: <a href="./_c_o_o_r_d_i_n_a_t_i_o_n.html" style="color:green">COORDINATION</a> GROUPA=chainA GROUPB=chainB NOPBC R_0=1.0
</pre><p>3) A CV describing the relative orientation of the two chains.</p>
<p>This can be achieved, for example, by defining suitable virtual atoms with the <a class="el" href="_c_e_n_t_e_r.html">CENTER</a> keyword and the <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a> CV:</p>
<pre class="fragment">
<span style="color:blue"># virtual atom representing the first half of chain A</span>
chainA_1: <a href="./_c_e_n_t_e_r.html" style="color:green">CENTER</a> ATOMS=<span style="background-color:yellow">__FILL__</span>
<span style="color:blue"># virtual atom representing the second half of chain A</span>
chainA_2: <a href="./_c_e_n_t_e_r.html" style="color:green">CENTER</a> ATOMS=<span style="background-color:yellow">__FILL__</span>

<span style="color:blue"># virtual atom representing the first half of chain B</span>
chainB_1: <a href="./_c_e_n_t_e_r.html" style="color:green">CENTER</a> ATOMS=<span style="background-color:yellow">__FILL__</span>
<span style="color:blue"># virtual atom representing the second half of chain B</span>
chainB_2: <a href="./_c_e_n_t_e_r.html" style="color:green">CENTER</a> ATOMS=<span style="background-color:yellow">__FILL__</span>

<span style="color:blue"># torsion CV</span>
dih: <a href="./_t_o_r_s_i_o_n.html" style="color:green">TORSION</a> ATOMS=<span style="background-color:yellow">__FILL__</span>
</pre><h1><a class="anchor" id="trieste-6-ex-2"></a>
Exercise 2: analysis of the cmyc-urea simulation</h1>
<p>Cmyc is a small disordered peptide made of 11 aminoacid. In solution, cmyc adopts a variety of different, but equally populated conformations. In the TARBALL of this exercise, we provide a long MD simulation of cmyc in presence of a single molecule of urea.</p>
<p><a class="anchor" id="trieste-6-cmycurea"></a></p><div class="image">
<img src="trieste-6-cmycurea.png" alt="trieste-6-cmycurea.png"/>
<div class="caption">
The cmyc peptide in presence of one urea molecule</div></div>
 <dl class="section note"><dt>Note</dt><dd>We encourage the users to get familiar with the system by visualizing the MD trajectory using <code>VMD</code>.</dd></dl>
<p>The users are expected to:</p><ul>
<li>characterize the conformational ensemble of cmyc by calculating free-energies as a function of different CVs.</li>
<li>calculate the fraction of bound and unbound molecules of urea by defining suitable CVs to measure the position of urea relative to cmyc.</li>
<li>find the cmyc aminoacids that bind urea the most and the least.</li>
<li>calculate the ensemble averages of different experimental CVs.</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Be careful that the original trajectory might be broken by PBC!</dd></dl>
<p>The users are free to choose his/her favorite CVs and they are encouraged to use the on-line manual to create their own PLUMED input file. However, we encourage all the users to experiment at least with the following CVs to characterize the conformational landscape of cmyc:</p>
<p>1) the radius of gyration of cmyc (<a class="el" href="_g_y_r_a_t_i_o_n.html">GYRATION</a>)</p>
<p>2) the content of alpha (<a class="el" href="_a_l_p_h_a_r_m_s_d.html">ALPHARMSD</a>) and beta (<a class="el" href="_a_n_t_i_b_e_t_a_r_m_s_d.html">ANTIBETARMSD</a>) secondary structure</p>
<p>The fraction of bound and unbound molecules of urea can be computed after evaluating the minimum distance among all the distances between heavy atoms of cmyc and urea, as follows:</p>
<pre class="fragment">
<span style="color:blue"># cmyc heavy atoms </span>
cmyc: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS=5,6,7,9,11,14,15,17,19,22,24,26,27,28,30,32,34,38,41,45,46,47,49,51,54,56,60,64,65,66,68,70,73,75,76,77,79,81,83,87,91,92,93,95,97,100,103,104,105,108,109,110,112,114,118,119,120,122,124,127,130,131,132,133,134,135,137,139,142,145,146,147,148,149,150,152,154,157,160,161,162,165,166,167,169,171,174,177,180,183,187,188

<span style="color:blue"># urea heavy atoms</span>
urea: <a href="./_g_r_o_u_p.html" style="color:green">GROUP</a> ATOMS=192,193,194,197

<span style="color:blue"># minimum distance cmyc-urea </span>
mindist: <a href="./_d_i_s_t_a_n_c_e_s.html" style="color:green">DISTANCES</a> GROUPA=cmyc GROUPB=urea MIN={BETA=50.}
</pre><p>For estimating the cmyc aminoacid that bind the most and the least urea, we leave the users the choice of the best strategy.</p>
<p>For the calculation of ensemble averages of experimental CVs, we suggest to use:</p>
<p>1) 3J scalar couplings (<a class="el" href="_j_c_o_u_p_l_i_n_g.html">JCOUPLING</a>)</p>
<p>2) the FRET intensity between termini (<a class="el" href="_f_r_e_t.html">FRET</a>) <br />
 and we encourage the users to look at the examples provided in the manual for the exact syntax.</p>
<h1><a class="anchor" id="trieste-6-ex-3"></a>
Exercise 3: Protein G folding simulations</h1>
<p>GB1 is a small protein domain with a simple beta-alpha-beta fold. It is a well studied protein that folds on the millisecond time scale. Here we use a structure based potential and well-tempered metadynamics to study the free energy of folding and unfolding. In the TARBALL of this exercise we provide the files needed to run the simulation, the user should write the plumed input file needed to bias the sampling.</p>
<p><a class="anchor" id="trieste-6-pgb"></a></p><div class="image">
<img src="trieste-6-gb.png" alt="trieste-6-gb.png"/>
<div class="caption">
The crystal structure of the protein G B1 domain</div></div>
<p> The users are expected to:</p><ul>
<li>setup and perform a well-tempered metadynamics simulation</li>
<li>evaluate convergence and error calculation of the metadynamics simulation</li>
<li>calculate the free energy difference between the folded and unfolded state of this protein</li>
<li>evaluate the robustness of the former by reweighting the resulting free energy as function of different CVs</li>
</ul>
<p>The users are free to choose his/her favorite CVs and they are encouraged to use the on-line manual to create their own PLUMED input file. However, we encourage all the users to experiment at least with the following CVs to characterize the free-energy landscape of GB1:</p>
<ul>
<li><a class="el" href="_r_m_s_d.html">RMSD</a> with respect to the folded state</li>
<li><a class="el" href="_g_y_r_a_t_i_o_n.html">GYRATION</a></li>
<li><a class="el" href="_a_l_p_h_a_b_e_t_a.html">ALPHABETA</a></li>
<li><a class="el" href="_d_i_h_c_o_r.html">DIHCOR</a></li>
</ul>
<p>The users should select two of them for the <a class="el" href="_m_e_t_a_d.html">METAD</a> simulation. Once you are satisfied by the convergence of your simulation, you can use one of the reweighting algorithms proposed to evaluate the free-energy difference between folded and unfolded state as a function of multiple collective variables.</p>
<pre class="fragment">
<span style="color:blue">#this allows you to use short-cut for dihedral angles</span>
<a href="./_m_o_l_i_n_f_o.html" style="color:green">MOLINFO</a> STRUCTURE=GB1_native.pdb

<span style="color:blue">#add here the collective variables you want to bias</span>

<span style="color:blue">#add here the METAD bias, remember that you need to set: one SIGMA per CV, one single HEIGHT, one BIASFACTOR and one PACE. </span>
<span style="color:blue">#Using GRIDS can increase the performances, so set a as many GRID_MIN and GRID_MAX as the number of CVs with reasonable ranges </span>
<span style="color:blue">#(i.e an RMSD will range between 0 and 3, while ALPHABETA and DIHCOR will range between 0 and N of dihedrals). </span>

<span style="color:blue">#add here the printing</span>
</pre><h1><a class="anchor" id="trieste-6-conclusions"></a>
Conclusions</h1>
<p>In summary, in this tutorial you should have learned how to use PLUMED to:</p><ul>
<li>Analyze trajectories of realistic biological systems using complex CVs</li>
<li>Extract conformations that correspond to local free-energy minima</li>
<li>Apply block analysis to estimate error in the reconstructed free-energy profiles</li>
<li>Calculate ensemble averages of experimental CVs</li>
<li>Reweight well-tempered metadynamics simulations </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
