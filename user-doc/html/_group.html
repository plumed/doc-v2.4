<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>PLUMED: Groups and Virtual Atoms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table align="center" frame="void" width="98%" cellpadding="2%">
<tbody>
<tr style="height: 30px;">
<td valign="center"> &nbsp; <img src="pigeon.png" width="120"/></td>
<td style="padding-left: 0.2em;" width="74%"> <a href="http://www.plumed.org"> <img src="logo.png" width="400" /> </td>
<td style="padding-left: 0.2em;" align="right"> <a href="../../developer-doc/html/index.html"> <img src="user-logo.png" width="180" /> </a> </td>
</tr>
</tbody>
</table>
<!--
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PLUMED
   &#160;<span id="projectnumber">2.4.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
-->
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_group.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Groups and Virtual Atoms </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="atomSpecs"></a>
Specifying Atoms</h1>
<p>The vast majority of the CVs implemented in PLUMED are calculated from a list of atom positions. Within PLUMED atoms are specified using their numerical indices in the molecular dynamics input file.</p>
<p>In PLUMED lists of atoms can be either provided directly inside the definition of each collective variable, or predefined as a <a class="el" href="_g_r_o_u_p.html">GROUP</a> that can be reused multiple times. Lists of atoms can be written as:</p>
<ul>
<li>comma separated lists of numbers (GROUP ATOMS=10,11,15,20 LABEL=g1)</li>
<li>numerical ranges. So GROUP ATOMS=10-20 LABEL=g2 is equivalent to GROUP ATOMS=10,11,12,13,14,15,16,17,18,19,20 LABEL=g2</li>
<li>numerical ranges with a stride. So GROUP ATOMS=10-100:10 LABEL=g3 is equivalent to GROUP ATOMS=10,20,30,40,50,60,70,80,90,100 LABEL=g3</li>
<li>atoms ranges with a negative stride. So GROUP ATOMS=100-10:-10 LABEL=g4 is equivalent to GROUP ATOMS=100,90,80,70,60,50,40,30,20,10 LABEL=g4</li>
<li>all the above methods together. For example GROUP ATOMS=1,2,10-20,40-60:5,100-70:-2 LABEL=g5.</li>
</ul>
<p>Some collective variable must accept a fixed number of atoms, for example a <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> is calculated using two atoms only, an <a class="el" href="_a_n_g_l_e.html">ANGLE</a> is calcuated using either 3 or 4 atoms and <a class="el" href="_t_o_r_s_i_o_n.html">TORSION</a> is calculated using 4 atoms.</p>
<p>Additional material and examples can be also found in the tutorial <a class="el" href="belfast-1.html">Belfast tutorial: Analyzing CVs</a>.</p>
<h2><a class="anchor" id="mols"></a>
Molecules</h2>
<p>In addition, for certain colvars, pdb files can be read in using the following keywords and used to select ATOMS:</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_m_o_l_i_n_f_o.html">MOLINFO</a>  </td><td>This command is used to provide information on the molecules that are present in your system.  </td></tr>
</table>
<h2><a class="anchor" id="pbc"></a>
Broken Molecules and PBC</h2>
<p>PLUMED is designed so that for the majority of the CVs implemented the periodic boundary conditions are treated in the same manner as they would be treated in the host code. In some codes this can be problematic when the colvars you are using involve some property of a molecule. These codes allow the atoms in the molecules to become separated by periodic boundaries, a fact which PLUMED could only deal with were the topology passed from the MD code to PLUMED. Making this work would involve a lot laborious programming and goes against our original aim of having a general patch that can be implemented in a wide variety of MD codes. Consequentially, we have implemented a more pragmatic solution to this probem - the user specifies in input any molecules (or parts of molecules) that must be kept in tact throughout the simulation run. In PLUMED 1 this was done using the ALIGN_ATOMS keyword. In PLUMED 2 the same effect can be achieved using the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> command.</p>
<p>The following input computes the end-to-end distance for a polymer of 100 atoms and keeps it at a value around 5.</p>
<pre class="fragment">
<a href="./_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> ENTITY0=1-100
e2e: <a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=1,100 NOPBC
<a href="./_r_e_s_t_r_a_i_n_t.html" style="color:green">RESTRAINT</a> ARG=e2e KAPPA=1 AT=5
</pre><p>Notice that NOPBC is used to be sure in <a class="el" href="_d_i_s_t_a_n_c_e.html">DISTANCE</a> that if the end-to-end distance is larger than half the simulation box the distance is compute properly. Also notice that, since many MD codes break molecules across cell boundary, it might be necessary to use the <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> keyword (also notice that it should be before distance).</p>
<p>Notice that most expressions are invariant with respect to a change in the order of the atoms, but some of them depend on that order. E.g., with <a class="el" href="_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html">WHOLEMOLECULES</a> it could be useful to specify atom lists in a reversed order.</p>
<pre class="fragment">
<span style="color:blue"># to see the effect, one could dump the atoms as they were before molecule reconstruction:</span>
<span style="color:blue"># DUMPATOMS FILE=dump-broken.xyz ATOMS=1-20</span>
<a href="./_w_h_o_l_e_m_o_l_e_c_u_l_e_s.html" style="color:green">WHOLEMOLECULES</a> STRIDE=1 ENTITY0=1-20
<a href="./_d_u_m_p_a_t_o_m_s.html" style="color:green">DUMPATOMS</a> FILE=dump.xyz ATOMS=1-20
</pre><p>Notice that there are other ways to manipulate the coordinates stored within PLUMED:</p><ul>
<li>Using the <a class="el" href="_f_i_t__t_o__t_e_m_p_l_a_t_e.html">FIT_TO_TEMPLATE</a> they can be aligned to a template structure.</li>
<li>Using <a class="el" href="_w_r_a_p_a_r_o_u_n_d.html">WRAPAROUND</a> you can bring a set of atom as close as possible to another set of atoms.</li>
<li>Using <a class="el" href="_r_e_s_e_t__c_e_l_l.html">RESET_CELL</a> you can rotate the periodic cell.</li>
</ul>
<h1><a class="anchor" id="vatoms"></a>
Virtual Atoms</h1>
<p>Sometimes, when calculating a colvar, you may not want to use the positions of a number of atoms directly. Instead you may wish to use the position of a virtual atom whose position is generated based on the positions of a collection of other atoms. For example you might want to use the center of mass of a group of atoms. Plumed has a number of routines for calculating the positions of these virtual atoms from lists of atoms:</p>
<table align="center" frame="void" width="95%%" cellpadding="5%%">
<tr>
<td width="5%"><a class="el" href="_c_e_n_t_e_r.html">CENTER</a>  </td><td>Calculate the center for a group of atoms, with arbitrary weights.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_c_e_n_t_e_r__o_f__m_u_l_t_i_c_o_l_v_a_r.html">CENTER_OF_MULTICOLVAR</a>  </td><td>Calculate a a weighted average position based on the value of some multicolvar.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_c_o_m.html">COM</a>  </td><td>Calculate the center of mass for a group of atoms.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_f_i_x_e_d_a_t_o_m.html">FIXEDATOM</a>  </td><td>Add a virtual atom in a fixed position.  </td></tr>
<tr>
<td width="5%"><a class="el" href="_g_h_o_s_t.html">GHOST</a>  </td><td>Calculate the absolute position of a ghost atom with fixed coordinatesin the local reference frame formed by three atoms.The computed ghost atom is stored as a virtual atom that can be accessed inan atom list through the the label for the GHOST action that creates it.  </td></tr>
</table>
<p>To specify to a colvar that you want to use the position of a virtual atom to calculate a colvar rather than one of the atoms in your system you simply use the label for your virtual atom in place of the usual numerical index. Virtual atoms and normal atoms can be mixed together in the input to colvars as shown below:</p>
<pre class="fragment">
<a href="./_c_o_m.html" style="color:green">COM</a> ATOMS=1,10 LABEL=com1
<a href="./_d_i_s_t_a_n_c_e.html" style="color:green">DISTANCE</a> ATOMS=11,com1
</pre><p>If you don't want to calculate CVs from the virtual atom. That is to say you just want to monitor the position of a virtual atom (or any set of atoms) over the course of your trajectory you can do this using <a class="el" href="_d_u_m_p_a_t_o_m_s.html">DUMPATOMS</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.3.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
<!--    <li class="navelem"><a class="el" href="colvarintro.html">Collective Variables</a></li>  -->
    <li class="footer">   <!--- Generated by -->
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
